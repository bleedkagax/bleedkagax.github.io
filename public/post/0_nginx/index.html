<!doctype html><html class="not-ready lg:text-base" style=--bg:#faf8f1 lang=en-us dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Nginx - Kaga Blog</title>
<meta name=theme-color><meta name=description content="Introduction to Nginx
Nginx (pronounced as &ldquo;Engine-X&rdquo;) is a high-performance, open-source web server, reverse proxy server, and email (IMAP/POP3) proxy server. It is renowned for its ability to handle high concurrency, low memory usage, and exceptional speed, making it a popular choice for serving both static and dynamic content on the web.
What is Nginx?
Key Features

High Performance: Ability to handle thousands of concurrent connections with minimal memory footprint.
Reverse Proxying: Acts as an intermediary for requests from clients seeking resources from servers.
Load Balancing: Distributes incoming traffic across multiple servers to ensure reliability and uptime.
SSL/TLS Support: Provides secure connections using SSL/TLS protocols.
Caching: Reduces server load and improves response times by caching responses from backend servers.
Modular Architecture: Supports dynamic modules to extend its functionality.
Static and Dynamic Content Serving: Efficiently serves static files and dynamically generated content.

Use Cases

Web Servers: Serving websites and web applications.
Reverse Proxy: Forwarding requests to application servers like Node.js, Python, Ruby, etc.
Load Balancer: Distributing traffic across multiple backend servers.
API Gateway: Managing and routing API requests.
Content Caching: Storing frequently accessed content to enhance performance.

Prerequisites
Before diving into Nginx, ensure you have the following:"><meta name=author content="Kaga Blog"><link rel="preload stylesheet" as=style href=https://bleedkagax.github.io/main.min.css><link rel=preload as=image href=https://bleedkagax.github.io/theme.png><script defer src=https://bleedkagax.github.io/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://bleedkagax.github.io/favicon.ico><link rel=apple-touch-icon href=https://bleedkagax.github.io/apple-touch-icon.png><meta name=generator content="Hugo 0.134.0"><meta itemprop=name content="Nginx"><meta itemprop=description content="Introduction to Nginx Nginx (pronounced as “Engine-X”) is a high-performance, open-source web server, reverse proxy server, and email (IMAP/POP3) proxy server. It is renowned for its ability to handle high concurrency, low memory usage, and exceptional speed, making it a popular choice for serving both static and dynamic content on the web.
What is Nginx? Key Features High Performance: Ability to handle thousands of concurrent connections with minimal memory footprint. Reverse Proxying: Acts as an intermediary for requests from clients seeking resources from servers. Load Balancing: Distributes incoming traffic across multiple servers to ensure reliability and uptime. SSL/TLS Support: Provides secure connections using SSL/TLS protocols. Caching: Reduces server load and improves response times by caching responses from backend servers. Modular Architecture: Supports dynamic modules to extend its functionality. Static and Dynamic Content Serving: Efficiently serves static files and dynamically generated content. Use Cases Web Servers: Serving websites and web applications. Reverse Proxy: Forwarding requests to application servers like Node.js, Python, Ruby, etc. Load Balancer: Distributing traffic across multiple backend servers. API Gateway: Managing and routing API requests. Content Caching: Storing frequently accessed content to enhance performance. Prerequisites Before diving into Nginx, ensure you have the following:"><meta itemprop=datePublished content="2024-10-15T00:00:00+00:00"><meta itemprop=dateModified content="2024-10-15T00:00:00+00:00"><meta itemprop=wordCount content="3871"><meta itemprop=keywords content="SystemDesign"><meta property="og:url" content="https://bleedkagax.github.io/post/0_nginx/"><meta property="og:site_name" content="Kaga Blog"><meta property="og:title" content="Nginx"><meta property="og:description" content="Introduction to Nginx Nginx (pronounced as “Engine-X”) is a high-performance, open-source web server, reverse proxy server, and email (IMAP/POP3) proxy server. It is renowned for its ability to handle high concurrency, low memory usage, and exceptional speed, making it a popular choice for serving both static and dynamic content on the web.
What is Nginx? Key Features High Performance: Ability to handle thousands of concurrent connections with minimal memory footprint. Reverse Proxying: Acts as an intermediary for requests from clients seeking resources from servers. Load Balancing: Distributes incoming traffic across multiple servers to ensure reliability and uptime. SSL/TLS Support: Provides secure connections using SSL/TLS protocols. Caching: Reduces server load and improves response times by caching responses from backend servers. Modular Architecture: Supports dynamic modules to extend its functionality. Static and Dynamic Content Serving: Efficiently serves static files and dynamically generated content. Use Cases Web Servers: Serving websites and web applications. Reverse Proxy: Forwarding requests to application servers like Node.js, Python, Ruby, etc. Load Balancer: Distributing traffic across multiple backend servers. API Gateway: Managing and routing API requests. Content Caching: Storing frequently accessed content to enhance performance. Prerequisites Before diving into Nginx, ensure you have the following:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-10-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-15T00:00:00+00:00"><meta property="article:tag" content="SystemDesign"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nginx"><meta name=twitter:description content="Introduction to Nginx Nginx (pronounced as “Engine-X”) is a high-performance, open-source web server, reverse proxy server, and email (IMAP/POP3) proxy server. It is renowned for its ability to handle high concurrency, low memory usage, and exceptional speed, making it a popular choice for serving both static and dynamic content on the web.
What is Nginx? Key Features High Performance: Ability to handle thousands of concurrent connections with minimal memory footprint. Reverse Proxying: Acts as an intermediary for requests from clients seeking resources from servers. Load Balancing: Distributes incoming traffic across multiple servers to ensure reliability and uptime. SSL/TLS Support: Provides secure connections using SSL/TLS protocols. Caching: Reduces server load and improves response times by caching responses from backend servers. Modular Architecture: Supports dynamic modules to extend its functionality. Static and Dynamic Content Serving: Efficiently serves static files and dynamically generated content. Use Cases Web Servers: Serving websites and web applications. Reverse Proxy: Forwarding requests to application servers like Node.js, Python, Ruby, etc. Load Balancer: Distributing traffic across multiple backend servers. API Gateway: Managing and routing API requests. Content Caching: Storing frequently accessed content to enhance performance. Prerequisites Before diving into Nginx, ensure you have the following:"><link rel=canonical href=https://bleedkagax.github.io/post/0_nginx/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-[--w] px-8 lg:justify-center"><div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center"><a class="-translate-y-[1px] text-2xl font-medium" href=https://bleedkagax.github.io/>Kaga Blog</a><div class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-[--w] px-8 pb-16 pt-14 dark:prose-invert"><article><header class=mb-14><h1 class="!my-0 pb-2.5">Nginx</h1><div class="text-xs antialiased opacity-60"><time>Oct 15, 2024</time></div></header><section><h2 id=introduction-to-nginx>Introduction to Nginx</h2><p>Nginx (pronounced as &ldquo;Engine-X&rdquo;) is a high-performance, open-source web server, reverse proxy server, and email (IMAP/POP3) proxy server. It is renowned for its ability to handle high concurrency, low memory usage, and exceptional speed, making it a popular choice for serving both static and dynamic content on the web.</p><h2 id=what-is-nginx>What is Nginx?</h2><h3 id=key-features>Key Features</h3><ul><li><strong>High Performance:</strong> Ability to handle thousands of concurrent connections with minimal memory footprint.</li><li><strong>Reverse Proxying:</strong> Acts as an intermediary for requests from clients seeking resources from servers.</li><li><strong>Load Balancing:</strong> Distributes incoming traffic across multiple servers to ensure reliability and uptime.</li><li><strong>SSL/TLS Support:</strong> Provides secure connections using SSL/TLS protocols.</li><li><strong>Caching:</strong> Reduces server load and improves response times by caching responses from backend servers.</li><li><strong>Modular Architecture:</strong> Supports dynamic modules to extend its functionality.</li><li><strong>Static and Dynamic Content Serving:</strong> Efficiently serves static files and dynamically generated content.</li></ul><h3 id=use-cases>Use Cases</h3><ul><li><strong>Web Servers:</strong> Serving websites and web applications.</li><li><strong>Reverse Proxy:</strong> Forwarding requests to application servers like Node.js, Python, Ruby, etc.</li><li><strong>Load Balancer:</strong> Distributing traffic across multiple backend servers.</li><li><strong>API Gateway:</strong> Managing and routing API requests.</li><li><strong>Content Caching:</strong> Storing frequently accessed content to enhance performance.</li></ul><h2 id=prerequisites>Prerequisites</h2><p>Before diving into Nginx, ensure you have the following:</p><ul><li><strong>Basic Understanding of Web Servers:</strong> Familiarity with how web servers work.</li><li><strong>Command-Line Proficiency:</strong> Comfortable using the terminal/command prompt.</li><li><strong>Basic Networking Knowledge:</strong> Understanding of concepts like IP addresses, DNS, HTTP/HTTPS.</li><li><strong>Root/Sudo Access:</strong> Required for installing and configuring Nginx on servers.</li></ul><h2 id=installation>Installation</h2><h3 id=installing-on-ubuntudebian>Installing on Ubuntu/Debian</h3><ol><li><p><strong>Update Package List</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span></code></pre></div></li><li><p><strong>Install Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install nginx
</span></span></code></pre></div></li><li><p><strong>Start and Enable Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl start nginx
</span></span><span style=display:flex><span>sudo systemctl enable nginx
</span></span></code></pre></div></li><li><p><strong>Verify Installation</strong></p><p>Open your web browser and navigate to <code>http://your_server_ip/</code>. You should see the Nginx default welcome page.</p></li></ol><h3 id=installing-on-centosrhel>Installing on CentOS/RHEL</h3><ol><li><p><strong>Install EPEL Repository</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo yum install epel-release -y
</span></span></code></pre></div></li><li><p><strong>Install Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo yum install nginx -y
</span></span></code></pre></div></li><li><p><strong>Start and Enable Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl start nginx
</span></span><span style=display:flex><span>sudo systemctl enable nginx
</span></span></code></pre></div></li><li><p><strong>Adjust Firewall</strong></p><p>Allow HTTP and HTTPS traffic.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo firewall-cmd --permanent --add-service<span style=color:#f92672>=</span>http
</span></span><span style=display:flex><span>sudo firewall-cmd --permanent --add-service<span style=color:#f92672>=</span>https
</span></span><span style=display:flex><span>sudo firewall-cmd --reload
</span></span></code></pre></div></li><li><p><strong>Verify Installation</strong></p><p>Navigate to <code>http://your_server_ip/</code> in your browser to see the Nginx default page.</p></li></ol><h3 id=installing-on-macos>Installing on macOS</h3><p>You can install Nginx on macOS using Homebrew.</p><ol><li><p><strong>Install Homebrew</strong> (if not already installed)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/bin/bash -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li><li><p><strong>Install Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew install nginx
</span></span></code></pre></div></li><li><p><strong>Start Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>brew services start nginx
</span></span></code></pre></div></li><li><p><strong>Verify Installation</strong></p><p>Open <code>http://localhost:8080/</code> in your web browser to see the Nginx welcome page.</p></li></ol><h3 id=building-from-source>Building from Source</h3><p>Building Nginx from source allows customization by enabling specific modules.</p><ol><li><p><strong>Install Dependencies</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install -y build-essential libpcre3 libpcre3-dev zlib1g zlib1g-dev libssl-dev
</span></span></code></pre></div></li><li><p><strong>Download Nginx Source Code</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://nginx.org/download/nginx-1.21.6.tar.gz
</span></span><span style=display:flex><span>tar -zxvf nginx-1.21.6.tar.gz
</span></span><span style=display:flex><span>cd nginx-1.21.6/
</span></span></code></pre></div></li><li><p><strong>Configure Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --prefix<span style=color:#f92672>=</span>/usr/local/nginx --with-http_ssl_module
</span></span></code></pre></div><ul><li><code>--prefix</code>: Installation directory.</li><li><code>--with-http_ssl_module</code>: Enables SSL support.</li></ul></li><li><p><strong>Compile and Install</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div></li><li><p><strong>Start Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo /usr/local/nginx/sbin/nginx
</span></span></code></pre></div></li><li><p><strong>Verify Installation</strong></p><p>Visit <code>http://your_server_ip/</code> to see the Nginx welcome page.</p></li></ol><h2 id=basic-configuration>Basic Configuration</h2><h3 id=nginx-configuration-file-structure>Nginx Configuration File Structure</h3><p>Nginx configuration files are typically located at <code>/etc/nginx/nginx.conf</code> on Unix-based systems. The primary configuration is divided into several blocks:</p><ul><li><strong>Main Context:</strong> Global settings.</li><li><strong>Events Block:</strong> Handles connection-related settings.</li><li><strong>HTTP Block:</strong> Configures web server settings, including server blocks.</li><li><strong>Server Blocks:</strong> Define virtual hosts/sites.</li><li><strong>Location Blocks:</strong> Specify how to handle different request URIs.</li></ul><h3 id=understanding-the-nginxconf-file>Understanding the <code>nginx.conf</code> File</h3><p>Here is a breakdown of a typical <code>nginx.conf</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>user</span> <span style=color:#e6db74>www-data</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>worker_processes</span> <span style=color:#e6db74>auto</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>pid</span> <span style=color:#e6db74>/run/nginx.pid</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>events</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>worker_connections</span> <span style=color:#ae81ff>1024</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>include</span> <span style=color:#e6db74>/etc/nginx/mime.types</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>default_type</span> <span style=color:#e6db74>application/octet-stream</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>sendfile</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>keepalive_timeout</span> <span style=color:#ae81ff>65</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Logging
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>access_log</span> <span style=color:#e6db74>/var/log/nginx/access.log</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>error_log</span> <span style=color:#e6db74>/var/log/nginx/error.log</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Gzip Compression
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>gzip</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_types</span> <span style=color:#e6db74>text/plain</span> <span style=color:#e6db74>application/xml</span> <span style=color:#e6db74>text/css</span> <span style=color:#e6db74>application/javascript</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Server Block
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>example.com</span> <span style=color:#e6db74>www.example.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/html</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>index</span> <span style=color:#e6db74>index.html</span> <span style=color:#e6db74>index.htm</span> <span style=color:#e6db74>index.nginx-debian.html</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>try_files</span> $uri $uri/ =<span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Additional configurations...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Additional server blocks...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><ul><li><strong>Main Context:</strong> Sets user permissions, worker processes, and PID file location.</li><li><strong>Events Block:</strong> Configures connection-related settings like <code>worker_connections</code>.</li><li><strong>HTTP Block:</strong> Contains settings related to handling HTTP requests, including MIME types, logging, compression, and server blocks.</li><li><strong>Server Block:</strong> Defines settings for a virtual host, including ports, server names, root directory, index files, and location handling.</li></ul><h2 id=serving-static-content>Serving Static Content</h2><p>One of the fundamental uses of Nginx is to serve static files efficiently.</p><h3 id=basic-server-block>Basic Server Block</h3><p>Here&rsquo;s a simple server block configured to serve static content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/your_domain</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span> <span style=color:#e6db74>index.html</span> <span style=color:#e6db74>index.htm</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>try_files</span> $uri $uri/ =<span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=setting-up-root-and-index-files>Setting Up Root and Index Files</h3><ul><li><strong>root:</strong> Specifies the root directory where your website files are located.</li><li><strong>index:</strong> Defines the default file to serve when a directory is requested.</li></ul><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>example.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/usr/share/nginx/html</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span> <span style=color:#e6db74>index.html</span> <span style=color:#e6db74>index.htm</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>try_files</span> $uri $uri/ =<span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=handling-dynamic-content>Handling Dynamic Content</h2><p>Nginx can also handle dynamic content by forwarding requests to application servers.</p><h3 id=proxying-requests-to-application-servers>Proxying Requests to Application Servers</h3><p>Use the <code>proxy_pass</code> directive to forward requests to backend servers like Node.js, Python, Ruby, etc.</p><p><strong>Example: Proxying to a Node.js Server</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://localhost:3000</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Upgrade</span> $http_upgrade;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#39;upgrade&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_cache_bypass</span> $http_upgrade;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>proxy_pass:</strong> Forwards all requests to the specified backend server.</li><li><strong>proxy_set_header:</strong> Sets custom headers to maintain the original client details and support WebSockets.</li><li><strong>proxy_cache_bypass:</strong> Ensures that cached content is bypassed when necessary.</li></ul><h3 id=fastcgi-and-php-integration>FastCGI and PHP Integration</h3><p>Nginx can serve PHP applications using FastCGI processors like PHP-FPM.</p><p><strong>Example: Configuring Nginx to Serve PHP with PHP-FPM</strong></p><ol><li><p><strong>Install PHP and PHP-FPM</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install php-fpm
</span></span></code></pre></div></li><li><p><strong>Configure Nginx Server Block</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/your_domain</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>index</span> <span style=color:#e6db74>index.php</span> <span style=color:#e6db74>index.html</span> <span style=color:#e6db74>index.htm</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>try_files</span> $uri $uri/ =<span style=color:#ae81ff>404</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Pass PHP scripts to FastCGI server
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>\.php$</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>include</span> <span style=color:#e6db74>snippets/fastcgi-php.conf</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>fastcgi_pass</span> <span style=color:#e6db74>unix:/var/run/php/php7.4-fpm.sock</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Deny access to .htaccess files
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>/\.ht</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>deny</span> <span style=color:#e6db74>all</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ol><p><strong>Explanation:</strong></p><ul><li><strong>location ~ .php$:</strong> Matches PHP files.</li><li><strong>include snippets/fastcgi-php.conf:</strong> Includes default FastCGI parameters.</li><li><strong>fastcgi_pass:</strong> Specifies the FastCGI server address and socket.</li><li><strong>deny all:</strong> Denies access to hidden files like <code>.htaccess</code>.</li></ul><h2 id=load-balancing>Load Balancing</h2><p>Nginx can distribute incoming traffic across multiple backend servers to ensure reliability and improve performance.</p><h3 id=basic-load-balancing-methods>Basic Load Balancing Methods</h3><ol><li><p><strong>Round Robin (Default Method)</strong></p><p>Distributes requests sequentially across the backend servers.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend3.example.com</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p><strong>Least Connections</strong></p><p>Sends requests to the server with the fewest active connections.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>least_conn</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend3.example.com</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>least_conn:</strong> Nginx directive to enable least connections load balancing.</li></ul></li><li><p><strong>IP Hash</strong></p><p>Ensures that requests from the same client IP are always directed to the same backend server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>ip_hash</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend3.example.com</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>ip_hash:</strong> Nginx directive to enable IP hash load balancing.</li></ul></li></ol><h3 id=advanced-load-balancing-techniques>Advanced Load Balancing Techniques</h3><ol><li><p><strong>Session Persistence</strong></p><p>Ensures that a user&rsquo;s session is consistently routed to the same backend server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend3.example.com</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Cookie</span> $http_cookie;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>proxy_set_header Cookie $http_cookie:</strong> Passes cookies to maintain session persistence.</li></ul></li><li><p><strong>Health Checks</strong></p><p>Automatically detects and removes unhealthy backend servers from the rotation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend3.example.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Health check parameters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>keepalive</span> <span style=color:#ae81ff>32</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Note:</strong> Nginx core does not support active health checks. For active health checks, consider using the <strong>Nginx Plus</strong> version or integrating with external tools like <strong>Consul</strong>.</p></li><li><p><strong>Dynamic Load Balancing with Variables</strong></p><p>Use variables to dynamically select backend servers based on request attributes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>upstream</span> <span style=color:#e6db74>backend</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend1.example.com</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server</span> <span style=color:#e6db74>backend2.example.com</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>set</span> $backend <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>if</span> <span style=color:#e6db74>(</span>$arg_site = <span style=color:#e6db74>&#34;site1&#34;)</span> {
</span></span><span style=display:flex><span>                <span style=color:#f92672>set</span> $backend <span style=color:#e6db74>&#34;backend1.example.com&#34;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#f92672>if</span> <span style=color:#e6db74>(</span>$arg_site = <span style=color:#e6db74>&#34;site2&#34;)</span> {
</span></span><span style=display:flex><span>                <span style=color:#f92672>set</span> $backend <span style=color:#e6db74>&#34;backend2.example.com&#34;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://</span>$backend;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ol><h2 id=security-best-practices>Security Best Practices</h2><p>Securing your Nginx server is crucial to protect your web applications and data.</p><h3 id=ssltls-configuration>SSL/TLS Configuration</h3><p>Implement SSL/TLS to encrypt data between clients and your server.</p><ol><li><p><strong>Obtain SSL Certificates</strong></p><ul><li><p><strong>Using Let&rsquo;s Encrypt:</strong> Free SSL certificates via Certbot.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install certbot python3-certbot-nginx
</span></span><span style=display:flex><span>sudo certbot --nginx -d your_domain.com -d www.your_domain.com
</span></span></code></pre></div></li></ul></li><li><p><strong>Configure SSL in Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span> <span style=color:#e6db74>www.your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate</span> <span style=color:#e6db74>/etc/letsencrypt/live/your_domain.com/fullchain.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/letsencrypt/live/your_domain.com/privkey.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_protocols</span> <span style=color:#e6db74>TLSv1.2</span> <span style=color:#e6db74>TLSv1.3</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_ciphers</span> <span style=color:#e6db74>HIGH:!aNULL:!MD5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        <span style=color:#75715e># Additional proxy settings...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span> <span style=color:#e6db74>www.your_domain.com</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>return</span> <span style=color:#ae81ff>301</span> <span style=color:#e6db74>https://</span>$host$request_uri;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>listen 443 ssl;</strong>: Listens for HTTPS connections.</li><li><strong>ssl_certificate:</strong> Path to the SSL certificate.</li><li><strong>ssl_certificate_key:</strong> Path to the SSL certificate key.</li><li><strong>ssl_protocols:</strong> Specifies allowed TLS protocols.</li><li><strong>ssl_ciphers:</strong> Defines strong ciphers.</li></ul></li><li><p><strong>Enable HTTP/2</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span> <span style=color:#e6db74>www.your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate</span> <span style=color:#e6db74>/etc/letsencrypt/live/your_domain.com/fullchain.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/letsencrypt/live/your_domain.com/privkey.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_protocols</span> <span style=color:#e6db74>TLSv1.2</span> <span style=color:#e6db74>TLSv1.3</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_ciphers</span> <span style=color:#e6db74>HIGH:!aNULL:!MD5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        <span style=color:#75715e># Additional proxy settings...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>http2:</strong> Enables HTTP/2 protocol for improved performance.</li></ul></li></ol><h3 id=restricting-access>Restricting Access</h3><p>Control access to sensitive resources and restrict unwanted traffic.</p><ol><li><p><strong>Restrict Access by IP Address</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/admin</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>allow</span> <span style=color:#ae81ff>192</span><span style=color:#e6db74>.168.1.0/24</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>deny</span> <span style=color:#e6db74>all</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://admin_backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>allow 192.168.1.0/24;</strong>: Allows access from the specified IP range.</li><li><strong>deny all;</strong>: Denies access to all other IPs.</li></ul></li><li><p><strong>Password Protection with HTTP Basic Auth</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install apache2-utils
</span></span><span style=display:flex><span>sudo htpasswd -c /etc/nginx/.htpasswd user1
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>apache2-utils:</strong> Provides <code>htpasswd</code> utility to create password files.</li><li><strong>htpasswd -c /etc/nginx/.htpasswd user1:</strong> Creates a new password file and adds <code>user1</code>.</li></ul><p><strong>Nginx Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/secure</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>auth_basic</span> <span style=color:#e6db74>&#34;Restricted</span> <span style=color:#e6db74>Area&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>auth_basic_user_file</span> <span style=color:#e6db74>/etc/nginx/.htpasswd</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://secure_backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>auth_basic:</strong> Enables basic authentication with a realm name.</li><li><strong>auth_basic_user_file:</strong> Specifies the path to the password file.</li></ul></li></ol><h3 id=preventing-common-attacks>Preventing Common Attacks</h3><ol><li><p><strong>DDoS Protection</strong></p><p>Implement rate limiting to mitigate DDoS attacks.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>limit_req_zone</span> $binary_remote_addr <span style=color:#e6db74>zone=one:10m</span> <span style=color:#e6db74>rate=1r/s</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>limit_req</span> <span style=color:#e6db74>zone=one</span> <span style=color:#e6db74>burst=5</span> <span style=color:#e6db74>nodelay</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>limit_req_zone:</strong> Defines a shared memory zone named <code>one</code> with a rate of 1 request per second.</li><li><strong>limit_req:</strong> Applies the rate limit to requests in the specified location.</li></ul></li><li><p><strong>Preventing Clickjacking</strong></p><p>Add <code>X-Frame-Options</code> header to prevent the website from being framed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-Frame-Options</span> <span style=color:#e6db74>&#34;SAMEORIGIN&#34;</span> <span style=color:#e6db74>always</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>add_header X-Frame-Options &ldquo;SAMEORIGIN&rdquo; always;</strong>: Prevents the site from being embedded in iframes from different origins.</li></ul></li><li><p><strong>Content Security Policy (CSP)</strong></p><p>Define a CSP to prevent cross-site scripting (XSS) and other code injection attacks.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>add_header</span> <span style=color:#e6db74>Content-Security-Policy</span> <span style=color:#e6db74>&#34;default-src</span> <span style=color:#e6db74>&#39;self&#39;</span>; <span style=color:#f92672>script-src</span> <span style=color:#e6db74>&#39;self&#39;</span> <span style=color:#e6db74>https://cdnjs.cloudflare.com</span>;<span style=color:#f92672>&#34;</span> <span style=color:#e6db74>always</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>add_header Content-Security-Policy:</strong> Sets the CSP header to restrict sources of content.</li></ul></li></ol><h2 id=performance-optimization>Performance Optimization</h2><p>Enhance Nginx&rsquo;s performance to handle high traffic efficiently.</p><h3 id=caching>Caching</h3><p>Implement caching strategies to reduce server load and improve response times.</p><ol><li><p><strong>Proxy Caching</strong></p><p>Cache responses from backend servers.</p><p><strong>Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_cache_path</span> <span style=color:#e6db74>/var/cache/nginx</span> <span style=color:#e6db74>levels=1:2</span> <span style=color:#e6db74>keys_zone=my_cache:10m</span> <span style=color:#e6db74>max_size=10g</span> <span style=color:#e6db74>inactive=60m</span> <span style=color:#e6db74>use_temp_path=off</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/api/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_cache</span> <span style=color:#e6db74>my_cache</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_cache_valid</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>302</span> <span style=color:#ae81ff>10m</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_cache_valid</span> <span style=color:#ae81ff>404</span>      <span style=color:#ae81ff>1m</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_cache_use_stale</span> <span style=color:#e6db74>error</span> <span style=color:#e6db74>timeout</span> <span style=color:#e6db74>updating</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-Proxy-Cache</span> $upstream_cache_status;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>proxy_cache_path:</strong> Defines cache storage path and parameters.</li><li><strong>proxy_cache:</strong> Enables caching for the specified location.</li><li><strong>proxy_cache_valid:</strong> Sets cache duration based on response statuses.</li><li><strong>proxy_cache_use_stale:</strong> Serves stale content under specific conditions.</li><li><strong>add_header X-Proxy-Cache:</strong> Adds a header indicating cache status.</li></ul></li><li><p><strong>FastCGI Caching</strong></p><p>Cache responses from FastCGI servers like PHP-FPM.</p><p><strong>Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>fastcgi_cache_path</span> <span style=color:#e6db74>/var/cache/nginx</span> <span style=color:#e6db74>levels=1:2</span> <span style=color:#e6db74>keys_zone=fastcgi_cache:10m</span> <span style=color:#e6db74>inactive=60m</span> <span style=color:#e6db74>use_temp_path=off</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> ~ <span style=color:#e6db74>\.php$</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>fastcgi_pass</span> <span style=color:#e6db74>unix:/var/run/php/php7.4-fpm.sock</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>include</span> <span style=color:#e6db74>fastcgi_params</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>fastcgi_cache</span> <span style=color:#e6db74>fastcgi_cache</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>fastcgi_cache_valid</span> <span style=color:#ae81ff>200</span> <span style=color:#ae81ff>302</span> <span style=color:#ae81ff>10m</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>fastcgi_cache_valid</span> <span style=color:#ae81ff>404</span>      <span style=color:#ae81ff>1m</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>fastcgi_cache_use_stale</span> <span style=color:#e6db74>error</span> <span style=color:#e6db74>timeout</span> <span style=color:#e6db74>updating</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-FastCGI-Cache</span> $upstream_cache_status;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>fastcgi_cache_path:</strong> Defines FastCGI cache storage path and parameters.</li><li><strong>fastcgi_cache:</strong> Enables FastCGI caching for the specified location.</li></ul></li></ol><h3 id=gzip-compression>Gzip Compression</h3><p>Enable gzip compression to reduce the size of responses and improve load times.</p><p><strong>Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_disable</span> <span style=color:#e6db74>&#34;msie6&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_vary</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_proxied</span> <span style=color:#e6db74>any</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_comp_level</span> <span style=color:#ae81ff>6</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_buffers</span> <span style=color:#ae81ff>16</span> <span style=color:#ae81ff>8k</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>gzip_types</span> <span style=color:#e6db74>text/plain</span> <span style=color:#e6db74>application/xml</span> <span style=color:#e6db74>text/css</span> <span style=color:#e6db74>application/javascript</span> <span style=color:#e6db74>image/svg+xml</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>gzip on;</strong>: Enables gzip compression.</li><li><strong>gzip_disable &ldquo;msie6&rdquo;;</strong>: Disables gzip for old browsers.</li><li><strong>gzip_vary on;</strong>: Adds <code>Vary: Accept-Encoding</code> header.</li><li><strong>gzip_comp_level:</strong> Sets compression level (1-9).</li><li><strong>gzip_buffers:</strong> Defines buffer size for compression.</li><li><strong>gzip_http_version:</strong> Minimum HTTP version for gzip.</li><li><strong>gzip_types:</strong> Specifies MIME types to compress.</li></ul><h3 id=buffer-adjustments>Buffer Adjustments</h3><p>Adjust buffer sizes to optimize request and response handling.</p><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>client_max_body_size</span> <span style=color:#e6db74>50M</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>client_body_buffer_size</span> <span style=color:#ae81ff>128k</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>large_client_header_buffers</span> <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>16k</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>client_body_timeout</span> <span style=color:#ae81ff>12</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>client_header_timeout</span> <span style=color:#ae81ff>12</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>send_timeout</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>client_max_body_size:</strong> Limits the maximum allowed size of the client request body.</li><li><strong>client_body_buffer_size:</strong> Sets the buffer size for reading client request body.</li><li><strong>large_client_header_buffers:</strong> Defines buffers for large client headers.</li><li><strong>client_body_timeout, client_header_timeout, send_timeout:</strong> Sets timeouts for reading client requests and sending responses.</li></ul><h3 id=rate-limiting>Rate Limiting</h3><p>Control the rate of incoming requests to prevent abuse and ensure quality of service.</p><p><strong>Example: Rate Limiting Using Shared Memory Zones</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>limit_req_zone</span> $binary_remote_addr <span style=color:#e6db74>zone=one:10m</span> <span style=color:#e6db74>rate=1r/s</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>location</span> <span style=color:#e6db74>/api/</span> {
</span></span><span style=display:flex><span>            <span style=color:#f92672>limit_req</span> <span style=color:#e6db74>zone=one</span> <span style=color:#e6db74>burst=5</span> <span style=color:#e6db74>nodelay</span>;
</span></span><span style=display:flex><span>            <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>limit_req_zone:</strong> Defines a shared memory zone for rate limiting based on the client IP.</li><li><strong>limit_req:</strong> Applies rate limiting to the specified location.</li></ul><h2 id=monitoring-and-logging>Monitoring and Logging</h2><p>Effective monitoring and logging are essential for maintaining and troubleshooting your Nginx server.</p><h3 id=access-logs>Access Logs</h3><p>Access logs record all incoming requests, providing valuable insights into traffic patterns and user behavior.</p><p><strong>Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>log_format</span> <span style=color:#e6db74>main</span> <span style=color:#e6db74>&#39;</span>$remote_addr <span style=color:#e6db74>-</span> $remote_user <span style=color:#e6db74>[</span>$time_local] <span style=color:#e6db74>&#34;</span>$request&#34; <span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;</span>$status $body_bytes_sent <span style=color:#e6db74>&#34;</span>$http_referer&#34; <span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#39;&#34;</span>$http_user_agent&#34; <span style=color:#e6db74>&#34;</span>$http_x_forwarded_for&#34;&#39;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>access_log</span> <span style=color:#e6db74>/var/log/nginx/access.log</span> <span style=color:#e6db74>main</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>log_format:</strong> Defines the format of the log entries.</li><li><strong>access_log:</strong> Specifies the location and format of the access log.</li></ul><h3 id=error-logs>Error Logs</h3><p>Error logs capture server-side errors and issues, aiding in diagnosis and troubleshooting.</p><p><strong>Configuration:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>error_log</span> <span style=color:#e6db74>/var/log/nginx/error.log</span> <span style=color:#e6db74>warn</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>error_log:</strong> Specifies the location and log level (<code>debug</code>, <code>info</code>, <code>notice</code>, <code>warn</code>, <code>error</code>, <code>crit</code>, <code>alert</code>, <code>emerg</code>).</li></ul><h3 id=real-time-monitoring-with-ngx_http_stub_status_module>Real-time Monitoring with ngx_http_stub_status_module</h3><p>The <code>ngx_http_stub_status_module</code> provides a simple status page displaying basic server metrics.</p><p><strong>Configuration:</strong></p><ol><li><p><strong>Enable the Status Module</strong></p><p>Ensure the module is included during Nginx compilation. Most pre-built Nginx packages include this module by default.</p></li><li><p><strong>Configure the Status Page</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>8080</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>localhost</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/nginx_status</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>stub_status</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>allow</span> <span style=color:#ae81ff>127</span><span style=color:#e6db74>.0.0.1</span>; <span style=color:#75715e># Allow only local access
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#f92672>deny</span> <span style=color:#e6db74>all</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p><strong>Access the Status Page</strong></p><p>Navigate to <code>http://localhost:8080/nginx_status</code> to view real-time metrics:</p><pre tabindex=0><code>Active connections: 291 
server accepts handled requests
 1526989 1526989 2983949 
Reading: 12 Writing: 34 Waiting: 245 
</code></pre><p><strong>Explanation:</strong></p><ul><li><strong>Active connections:</strong> Current active connections.</li><li><strong>accepts/handled/requests:</strong> Total accepted, handled, and processed requests.</li><li><strong>Reading/Writing/Waiting:</strong> State of connections.</li></ul></li></ol><h2 id=advanced-features>Advanced Features</h2><p>Explore advanced functionalities of Nginx to streamline and enhance your web server capabilities.</p><h3 id=reverse-proxy>Reverse Proxy</h3><p>Implementing Nginx as a reverse proxy allows it to handle all client requests and distribute them to appropriate backend servers.</p><p><strong>Example: Reverse Proxy Setup</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend_server</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Real-IP</span> $remote_addr;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-For</span> $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>X-Forwarded-Proto</span> $scheme;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>proxy_pass:</strong> Forwards requests to the specified backend server.</li><li><strong>proxy_set_header:</strong> Sets headers to preserve client information.</li></ul><h3 id=using-nginx-as-a-mail-proxy>Using Nginx as a Mail Proxy</h3><p>Nginx can function as a mail proxy for IMAP, POP3, and SMTP protocols.</p><p><strong>Configuration Example for IMAP Proxy</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>mail</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>listen</span>     <span style=color:#ae81ff>143</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>protocol</span>   <span style=color:#e6db74>imap</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass_error_message</span> <span style=color:#66d9ef>on</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>auth_http</span>  localhost:<span style=color:#ae81ff>8080</span><span style=color:#e6db74>/auth</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>mail:</strong> Defines mail-related configurations.</li><li><strong>server:</strong> Configures the mail server.</li><li><strong>listen:</strong> Specifies the port and protocol.</li><li><strong>proxy_pass_error_message:</strong> Enables forwarding of error messages from the backend.</li><li><strong>auth_http:</strong> Defines the authentication server.</li></ul><h3 id=websockets-support>WebSockets Support</h3><p>Enable real-time, bidirectional communication using WebSockets.</p><p><strong>Configuration Example: WebSockets with Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/ws</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend_server</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_http_version</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>.1</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Upgrade</span> $http_upgrade;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Connection</span> <span style=color:#e6db74>&#34;Upgrade&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_set_header</span> <span style=color:#e6db74>Host</span> $host;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>proxy_http_version 1.1:</strong> Sets HTTP version to 1.1 to support WebSockets.</li><li><strong>proxy_set_header Upgrade $http_upgrade;</strong>: Passes the Upgrade header.</li><li><strong>proxy_set_header Connection &ldquo;Upgrade&rdquo;;</strong>: Maintains the connection upgrade.</li></ul><h3 id=http2-support>HTTP/2 Support</h3><p>Implement HTTP/2 for improved performance with features like multiplexing, header compression, and server push.</p><p><strong>Configuration Example: Enabling HTTP/2</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate</span> <span style=color:#e6db74>/etc/ssl/certs/your_domain.com.crt</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/ssl/private/your_domain.com.key</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>http2:</strong> Enables HTTP/2 protocol on the listen directive.</li><li><strong>ssl_certificate & ssl_certificate_key:</strong> Required for HTTPS and HTTP/2.</li></ul><h2 id=automation-with-nginx>Automation with Nginx</h2><p>Automate configuration management and deployments to streamline operations.</p><h3 id=automated-configuration-reloads>Automated Configuration Reloads</h3><p>Automatically reload Nginx configurations without downtime.</p><p><strong>Using <code>nginx -t</code> and <code>nginx -s reload</code></strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nginx -t <span style=color:#f92672>&amp;&amp;</span> sudo nginx -s reload
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>nginx -t:</strong> Tests the configuration for syntax errors.</li><li><strong>nginx -s reload:</strong> Reloads Nginx without stopping the service.</li></ul><h3 id=integration-with-cicd-pipelines>Integration with CI/CD Pipelines</h3><p>Integrate Nginx configuration deployments into CI/CD workflows for seamless updates.</p><p><strong>Example: GitLab CI/CD Configuration (<code>.gitlab-ci.yml</code>)</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>stages</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>test</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>deploy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>test_config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>test</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>sudo nginx -t</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>only</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>deploy_production</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>deploy</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>sudo nginx -s reload</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>only</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>tags</span>
</span></span></code></pre></div><p><strong>Explanation:</strong></p><ul><li><strong>test_config:</strong> Tests Nginx configuration on commit to master.</li><li><strong>deploy_production:</strong> Reloads Nginx after successful tests.</li></ul><h2 id=troubleshooting>Troubleshooting</h2><p>Identify and resolve common Nginx issues to maintain a healthy web server.</p><h3 id=common-issues-and-solutions>Common Issues and Solutions</h3><ol><li><p><strong>Nginx Not Starting</strong></p><ul><li><p><strong>Check Configuration Syntax:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nginx -t
</span></span></code></pre></div></li><li><p><strong>Inspect Error Logs:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tail -f /var/log/nginx/error.log
</span></span></code></pre></div></li><li><p><strong>Solution:</strong> Fix any syntax errors or conflicts in the configuration file.</p></li></ul></li><li><p><strong>403 Forbidden Error</strong></p><ul><li><p><strong>Cause:</strong> Incorrect file permissions or missing <code>index</code> file.</p></li><li><p><strong>Solution:</strong> Ensure Nginx has read permissions to the root directory and that an <code>index</code> file exists.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chown -R www-data:www-data /var/www/your_domain
</span></span><span style=display:flex><span>sudo chmod -R <span style=color:#ae81ff>755</span> /var/www/your_domain
</span></span></code></pre></div></li></ul></li><li><p><strong>502 Bad Gateway</strong></p><ul><li><strong>Cause:</strong> Backend server is down or misconfigured.</li><li><strong>Solution:</strong> Verify the backend server is running and accessible. Check Nginx proxy settings.</li></ul></li><li><p><strong>504 Gateway Timeout</strong></p><ul><li><p><strong>Cause:</strong> Backend server is taking too long to respond.</p></li><li><p><strong>Solution:</strong> Increase timeout settings in Nginx and ensure backend server performance.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://backend</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_read_timeout</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_connect_timeout</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxy_send_timeout</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li></ul></li></ol><h3 id=debugging-techniques>Debugging Techniques</h3><ol><li><p><strong>Enable Debug Logging</strong></p><p>Modify the <code>error_log</code> directive to include debug information.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>error_log</span> <span style=color:#e6db74>/var/log/nginx/error.log</span> <span style=color:#e6db74>debug</span>;
</span></span></code></pre></div><p><strong>Note:</strong> Debug logging can generate大量日志数据，应谨慎使用，避免在生产环境中启用。</p></li><li><p><strong>Use <code>curl</code> for Testing</strong></p><p>Test server responses and behavior using <code>curl</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -I http://your_domain.com/
</span></span><span style=display:flex><span>curl -v http://your_domain.com/api
</span></span></code></pre></div></li><li><p><strong>Analyze Access Logs</strong></p><p>Review access logs to understand traffic patterns and identify anomalies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tail -f /var/log/nginx/access.log
</span></span></code></pre></div></li><li><p><strong>Check System Resources</strong></p><p>Ensure the server has sufficient resources (CPU, memory, disk I/O).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>top
</span></span><span style=display:flex><span>df -h
</span></span></code></pre></div></li></ol><h2 id=extending-nginx-with-modules>Extending Nginx with Modules</h2><p>Enhance Nginx’s capabilities by integrating additional modules.</p><h3 id=third-party-modules>Third-Party Modules</h3><ol><li><p><strong>ngx_brotli</strong></p><p>Adds Brotli compression to Nginx.</p><p><strong>Installation:</strong></p><ul><li><p>Clone the module repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/google/ngx_brotli.git
</span></span><span style=display:flex><span>cd ngx_brotli
</span></span><span style=display:flex><span>git submodule update --init
</span></span></code></pre></div></li><li><p>Recompile Nginx with the module.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --add-module<span style=color:#f92672>=</span>/path/to/ngx_brotli
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div></li></ul></li><li><p><strong>ngx_pagespeed</strong></p><p>Optimizes web pages by automatically applying best practices.</p><p><strong>Installation:</strong></p><ul><li><p>Download Pagespeed module.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://dl.google.com/dl/page-speed/psol/1.13.35.2-x64.tar.gz
</span></span><span style=display:flex><span>tar -xzvf 1.13.35.2-x64.tar.gz
</span></span></code></pre></div></li><li><p>Recompile Nginx with Pagespeed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --add-module<span style=color:#f92672>=</span>/path/to/ngx_pagespeed-1.13.35.2-beta
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div></li></ul></li></ol><p><strong>Note:</strong> Third-party modules require recompiling Nginx from source. Consider using dynamic modules if supported.</p><h3 id=custom-module-development>Custom Module Development</h3><p>Develop custom modules to extend Nginx functionality specific to your needs.</p><ol><li><p><strong>Understand Nginx Module Architecture</strong></p><ul><li><strong>Handler Directives:</strong> Define how requests are processed.</li><li><strong>Configuration Directives:</strong> Customize module behavior.</li><li><strong>Context Types:</strong> Specify where directives can appear (<code>http</code>, <code>server</code>, <code>location</code>).</li></ul></li><li><p><strong>Set Up Development Environment</strong></p><ul><li>Install development dependencies.</li><li>Familiarize yourself with Nginx internals.</li></ul></li><li><p><strong>Create a Basic Module</strong></p><p><strong>Example: Hello World Module</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ngx_config.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ngx_core.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ngx_http.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ngx_http_hello_world</span>(<span style=color:#66d9ef>ngx_conf_t</span> <span style=color:#f92672>*</span>cf, <span style=color:#66d9ef>ngx_command_t</span> <span style=color:#f92672>*</span>cmd, <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>conf);
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>ngx_int_t</span> <span style=color:#a6e22e>ngx_http_handler</span>(<span style=color:#66d9ef>ngx_http_request_t</span> <span style=color:#f92672>*</span>r);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>ngx_command_t</span> ngx_http_hello_world_commands[] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ngx_string</span>(<span style=color:#e6db74>&#34;hello_world&#34;</span>),
</span></span><span style=display:flex><span>        NGX_HTTP_MAIN_CONF <span style=color:#f92672>|</span> NGX_CONF_NOARGS,
</span></span><span style=display:flex><span>        ngx_http_hello_world,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        NULL
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    ngx_null_command
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>ngx_http_module_t</span> ngx_http_hello_world_module_ctx <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    NULL, <span style=color:#75715e>// preconfiguration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// postconfiguration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    NULL, <span style=color:#75715e>// create main configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// init main configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    NULL, <span style=color:#75715e>// create server configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// merge server configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    NULL, <span style=color:#75715e>// create location configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL  <span style=color:#75715e>// merge location configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ngx_module_t</span> ngx_http_hello_world_module <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    NGX_MODULE_V1,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&amp;</span>ngx_http_hello_world_module_ctx,
</span></span><span style=display:flex><span>    ngx_http_hello_world_commands,
</span></span><span style=display:flex><span>    NGX_HTTP_MODULE,
</span></span><span style=display:flex><span>    NULL, <span style=color:#75715e>// init master
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// init module
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// init process
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// init thread
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// exit thread
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// exit process
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NULL, <span style=color:#75715e>// exit master
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    NGX_MODULE_V1_PADDING
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ngx_http_hello_world</span>(<span style=color:#66d9ef>ngx_conf_t</span> <span style=color:#f92672>*</span>cf, <span style=color:#66d9ef>ngx_command_t</span> <span style=color:#f92672>*</span>cmd, <span style=color:#66d9ef>void</span> <span style=color:#f92672>*</span>conf) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ngx_http_core_loc_conf_t</span> <span style=color:#f92672>*</span>clcf;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Get the core location config
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    clcf <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_http_conf_get_module_loc_conf</span>(cf, ngx_http_core_module);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Set the handler
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    clcf<span style=color:#f92672>-&gt;</span>handler <span style=color:#f92672>=</span> ngx_http_handler;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> NGX_CONF_OK;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>ngx_int_t</span> <span style=color:#a6e22e>ngx_http_handler</span>(<span style=color:#66d9ef>ngx_http_request_t</span> <span style=color:#f92672>*</span>r) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>(r<span style=color:#f92672>-&gt;</span>method <span style=color:#f92672>&amp;</span> NGX_HTTP_GET)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NGX_HTTP_NOT_ALLOWED;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ngx_str_t</span> response <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_string</span>(<span style=color:#e6db74>&#34;Hello, Nginx Module!&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Set response headers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>ngx_table_elt_t</span> <span style=color:#f92672>*</span>h;
</span></span><span style=display:flex><span>    h <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_list_push</span>(<span style=color:#f92672>&amp;</span>r<span style=color:#f92672>-&gt;</span>headers_out.headers);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (h <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NGX_HTTP_INTERNAL_SERVER_ERROR;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    h<span style=color:#f92672>-&gt;</span>key.len <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>(<span style=color:#e6db74>&#34;Content-Type&#34;</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    h<span style=color:#f92672>-&gt;</span>key.data <span style=color:#f92672>=</span> (u_char <span style=color:#f92672>*</span>) <span style=color:#e6db74>&#34;Content-Type&#34;</span>;
</span></span><span style=display:flex><span>    h<span style=color:#f92672>-&gt;</span>value.len <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>(<span style=color:#e6db74>&#34;text/plain&#34;</span>) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    h<span style=color:#f92672>-&gt;</span>value.data <span style=color:#f92672>=</span> (u_char <span style=color:#f92672>*</span>) <span style=color:#e6db74>&#34;text/plain&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    r<span style=color:#f92672>-&gt;</span>headers_out.status <span style=color:#f92672>=</span> NGX_HTTP_OK;
</span></span><span style=display:flex><span>    r<span style=color:#f92672>-&gt;</span>headers_out.content_length_n <span style=color:#f92672>=</span> response.len;
</span></span><span style=display:flex><span>    r<span style=color:#f92672>-&gt;</span>headers_out.content_type <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>value;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Send headers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>ngx_int_t</span> rc <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_http_send_header</span>(r);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (rc <span style=color:#f92672>==</span> NGX_ERROR <span style=color:#f92672>||</span> rc <span style=color:#f92672>&gt;</span> NGX_OK <span style=color:#f92672>||</span> r<span style=color:#f92672>-&gt;</span>header_only) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> rc;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Create buffer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>ngx_buf_t</span> <span style=color:#f92672>*</span>b <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_pcalloc</span>(r<span style=color:#f92672>-&gt;</span>pool, <span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>ngx_buf_t</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (b <span style=color:#f92672>==</span> NULL) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NGX_HTTP_INTERNAL_SERVER_ERROR;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    b<span style=color:#f92672>-&gt;</span>pos <span style=color:#f92672>=</span> response.data;
</span></span><span style=display:flex><span>    b<span style=color:#f92672>-&gt;</span>last <span style=color:#f92672>=</span> response.data <span style=color:#f92672>+</span> response.len;
</span></span><span style=display:flex><span>    b<span style=color:#f92672>-&gt;</span>memory <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// content is in memory
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    b<span style=color:#f92672>-&gt;</span>last_buf <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// this is the last buffer in the response
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Create chain link
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>ngx_chain_t</span> out;
</span></span><span style=display:flex><span>    out.buf <span style=color:#f92672>=</span> b;
</span></span><span style=display:flex><span>    out.next <span style=color:#f92672>=</span> NULL;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ngx_http_output_filter</span>(r, <span style=color:#f92672>&amp;</span>out);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p><strong>Compile Nginx with the Custom Module</strong></p><ul><li><p><strong>Download Nginx Source</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://nginx.org/download/nginx-1.21.6.tar.gz
</span></span><span style=display:flex><span>tar -zxvf nginx-1.21.6.tar.gz
</span></span><span style=display:flex><span>cd nginx-1.21.6/
</span></span></code></pre></div></li><li><p><strong>Copy Custom Module</strong></p><p>Save the custom module as <code>ngx_http_hello_world_module.c</code> in the Nginx source directory.</p></li><li><p><strong>Configure Nginx with the Custom Module</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --add-module<span style=color:#f92672>=</span>./ngx_http_hello_world_module
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>sudo make install
</span></span></code></pre></div></li><li><p><strong>Update Nginx Configuration to Use the Module</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>your_domain.com</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/hello</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>hello_world</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p><strong>Restart Nginx</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nginx -s reload
</span></span></code></pre></div></li><li><p><strong>Test the Module</strong></p><p>Navigate to <code>http://your_domain.com/hello</code> and you should see &ldquo;Hello, Nginx Module!&rdquo; displayed.</p></li></ul></li></ol><h3 id=benefits-of-extending-nginx-with-modules>Benefits of Extending Nginx with Modules</h3><ul><li><strong>Customized Functionality:</strong> Tailor Nginx to meet specific application requirements.</li><li><strong>Enhanced Performance:</strong> Optimize request handling and processing.</li><li><strong>Improved Security:</strong> Implement custom security measures and protocols.</li><li><strong>Scalability:</strong> Introduce features that facilitate the scaling of web services.</li></ul><h2 id=resources-and-further-reading>Resources and Further Reading</h2><h3 id=official-documentation>Official Documentation</h3><ul><li><strong>Nginx Official Site:</strong> <a href=https://nginx.org/>https://nginx.org/</a></li><li><strong>Nginx Documentation:</strong> <a href=https://nginx.org/en/docs/>https://nginx.org/en/docs/</a></li><li><strong>Nginx Wiki:</strong> <a href=https://www.nginx.com/resources/wiki/>https://www.nginx.com/resources/wiki/</a></li><li><strong>Nginx Blog:</strong> <a href=https://www.nginx.com/blog/>https://www.nginx.com/blog/</a></li></ul><h3 id=books-and-articles>Books and Articles</h3><ul><li><strong>&ldquo;Nginx: A Practical Guide to High Performance&rdquo;</strong> by Stephen Corona</li><li><strong>&ldquo;Mastering Nginx&rdquo;</strong> by Dimitri Aivaliotis</li><li><strong>&ldquo;Nginx Cookbook&rdquo;</strong> by Derek DeJonghe</li><li><strong>&ldquo;Nginx Essentials&rdquo;</strong> by Arun Kumar Maheshwari</li><li><strong>Official Nginx Blog Articles:</strong> Regularly updated with best practices and case studies.</li></ul><h3 id=online-tutorials-and-courses>Online Tutorials and Courses</h3><ul><li><strong>DigitalOcean Nginx Tutorials:</strong> <a href=https://www.digitalocean.com/community/tags/nginx>https://www.digitalocean.com/community/tags/nginx</a></li><li><strong>TutorialsPoint Nginx Tutorial:</strong> <a href=https://www.tutorialspoint.com/nginx/index.htm>https://www.tutorialspoint.com/nginx/index.htm</a></li><li><strong>Udemy Nginx Courses:</strong> <a href=https://www.udemy.com/topic/nginx/>https://www.udemy.com/topic/nginx/</a></li><li><strong>Coursera Web Server Management Courses:</strong> Search for Nginx-related courses.</li></ul><h3 id=community-and-support>Community and Support</h3><ul><li><strong>Nginx Forums:</strong> <a href=https://forum.nginx.org/>https://forum.nginx.org/</a></li><li><strong>Stack Overflow:</strong> Tag questions with <code>nginx</code> to get help from the community.</li><li><strong>Reddit r/nginx:</strong> <a href=https://www.reddit.com/r/nginx/>https://www.reddit.com/r/nginx/</a></li><li><strong>Nginx Slack:</strong> Join the <a href=https://nginx.slack.com/>official Nginx Slack workspace</a> for real-time discussions (requires invitation).</li><li><strong>GitHub Issues:</strong> Report bugs or request features in the <a href=https://github.com/nginx/nginx/issues>Nginx GitHub repository</a>.</li></ul><h2 id=conclusion>Conclusion</h2><p>Nginx is a versatile and powerful tool that plays a pivotal role in modern web infrastructure. From serving high-traffic websites to acting as a robust reverse proxy and load balancer, its capabilities are extensive and continually evolving.</p><p>This comprehensive tutorial has walked you through the essential aspects of Nginx, including installation, configuration, security, performance optimization, and extending its functionality with modules. By mastering these concepts and practices, you can effectively harness Nginx to build scalable, high-performance, and secure web services.</p><h3 id=key-takeaways>Key Takeaways</h3><ol><li><strong>Installation & Setup:</strong> Installing Nginx is straightforward across various operating systems, with comprehensive configuration options available.</li><li><strong>Configuration Mastery:</strong> Understanding the configuration file structure and directives is crucial for tailoring Nginx to your specific needs.</li><li><strong>Performance & Security:</strong> Implementing best practices in caching, compression, SSL/TLS, and access controls ensures optimal performance and robust security.</li><li><strong>Extensibility:</strong> Leveraging Nginx’s modular architecture allows for customized enhancements and integrations, catering to a wide array of use cases.</li><li><strong>Continuous Learning:</strong> Nginx is continuously updated with new features and improvements. Staying abreast with official documentation, community discussions, and advanced topics will further deepen your expertise.</li></ol><hr><p><em>Happy Nginx-ing!</em></p><pre tabindex=0><code></code></pre></section><footer class="mt-12 flex flex-wrap"><a class="mb-1.5 ltr:mr-1.5 rtl:ml-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] dark:bg-white/[8%] dark:hover:bg-white/[12%]" href=https://bleedkagax.github.io/tags/systemdesign>SystemDesign</a></footer><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://bleedkagax.github.io/post/1_lua/><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>Lua</span></a>
<a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href=https://bleedkagax.github.io/post/2_openresty/><span>Openresty</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script><script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid [&_svg]:block [&_svg]:m-auto">${e.innerHTML}</div>`})</script></article></main><footer class="mx-auto flex h-[4.5rem] max-w-[--w] items-center px-8 text-xs uppercase tracking-wider opacity-60"><div class=mr-auto>&copy; 2025
<a class=link href=https://bleedkagax.github.io/>Kaga Blog</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a></footer></body></html>