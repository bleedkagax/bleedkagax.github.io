<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Prometheus | Kaga Blog</title>
<meta name=keywords content="SystemDesign"><meta name=description content="

What is Prometheus?
Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.
What are the main components of Prometheus?
The main components of Prometheus are:

Prometheus server (for scraping and storing time series data)
Client libraries (for instrumenting application code)
Push gateway (for supporting short-lived jobs)
Exporters (for services that don&rsquo;t expose Prometheus metrics directly)
Alertmanager (for handling alerts)

How does Prometheus collect metrics?
Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets."><meta name=author content><link rel=canonical href=https://bleedkagax.github.io/post/2_prometheus/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://bleedkagax.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bleedkagax.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bleedkagax.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bleedkagax.github.io/apple-touch-icon.png><link rel=mask-icon href=https://bleedkagax.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://bleedkagax.github.io/post/2_prometheus/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Prometheus"><meta property="og:description" content="

What is Prometheus?
Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.
What are the main components of Prometheus?
The main components of Prometheus are:

Prometheus server (for scraping and storing time series data)
Client libraries (for instrumenting application code)
Push gateway (for supporting short-lived jobs)
Exporters (for services that don&rsquo;t expose Prometheus metrics directly)
Alertmanager (for handling alerts)

How does Prometheus collect metrics?
Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets."><meta property="og:type" content="article"><meta property="og:url" content="https://bleedkagax.github.io/post/2_prometheus/"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-09-07T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-07T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Prometheus"><meta name=twitter:description content="

What is Prometheus?
Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.
What are the main components of Prometheus?
The main components of Prometheus are:

Prometheus server (for scraping and storing time series data)
Client libraries (for instrumenting application code)
Push gateway (for supporting short-lived jobs)
Exporters (for services that don&rsquo;t expose Prometheus metrics directly)
Alertmanager (for handling alerts)

How does Prometheus collect metrics?
Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bleedkagax.github.io/post/"},{"@type":"ListItem","position":2,"name":"Prometheus","item":"https://bleedkagax.github.io/post/2_prometheus/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Prometheus","name":"Prometheus","description":" What is Prometheus? Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.\nWhat are the main components of Prometheus? The main components of Prometheus are:\nPrometheus server (for scraping and storing time series data) Client libraries (for instrumenting application code) Push gateway (for supporting short-lived jobs) Exporters (for services that don\u0026rsquo;t expose Prometheus metrics directly) Alertmanager (for handling alerts) How does Prometheus collect metrics? Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets.\n","keywords":["SystemDesign"],"articleBody":" What is Prometheus? Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.\nWhat are the main components of Prometheus? The main components of Prometheus are:\nPrometheus server (for scraping and storing time series data) Client libraries (for instrumenting application code) Push gateway (for supporting short-lived jobs) Exporters (for services that don’t expose Prometheus metrics directly) Alertmanager (for handling alerts) How does Prometheus collect metrics? Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets.\nWhat is PromQL? PromQL (Prometheus Query Language) is Prometheus’s flexible query language that lets the user select and aggregate time series data in real time.\nExplain the difference between counter, gauge, and histogram metric types in Prometheus. Counter: A cumulative metric that only increases (e.g., number of requests) Gauge: A metric that can increase and decrease (e.g., memory usage) Histogram: Samples observations and counts them in configurable buckets (e.g., request durations) What is service discovery in Prometheus? Service discovery is the process by which Prometheus automatically finds and monitors new targets in dynamic environments like cloud or container platforms.\nHow does Prometheus handle high availability? Prometheus can be run in a clustered mode for high availability. Multiple Prometheus servers can scrape the same targets, and Alertmanager can be clustered to provide redundancy for alerts.\nWhat is the role of Alertmanager in Prometheus? Alertmanager handles alerts sent by client applications such as the Prometheus server. It takes care of deduplicating, grouping, and routing alerts to the correct receiver (e.g., email, PagerDuty, Slack).\nHow does Prometheus store data? Prometheus stores data in a custom, efficient time-series database on local storage. It also optionally integrates with remote storage systems.\nWhat is the purpose of exporters in Prometheus? Exporters are used to export existing metrics from third-party systems as Prometheus metrics. They collect the metrics from the target system and translate them into a format that Prometheus can ingest.\nHow can you monitor Prometheus itself? Prometheus can monitor itself by scraping its own HTTP endpoint. This allows you to track metrics about Prometheus’ own performance and behavior.\nWhat is the difference between push and pull models in monitoring, and which does Prometheus use? Prometheus uses a pull model, where it actively scrapes targets for metrics. In contrast, a push model involves targets actively sending metrics to the monitoring system. Prometheus’ pull model is simpler and allows for better detection of failures.\nHow does Prometheus handle labels? Labels in Prometheus are key-value pairs associated with time series, e.g., environment=\"production\", server=\"backend-01\". They allow for multi-dimensional data model and flexible, powerful querying.\nWhat is recording rules in Prometheus? Recording rules allow you to precompute frequently needed or computationally expensive expressions and save their result as a new set of time series.\nHow does Prometheus ensure reliability and prevent data loss? Prometheus uses local storage by default, which prevents data loss due to network issues. It also supports various service discovery mechanisms and can be run in a clustered mode for high availability.\nPrometheus Underlying Data Structures 1. Time Series Database (TSDB) Custom-built for Prometheus Optimized for time-series data Supports efficient data compression and fast querying 2. Sample Data Each time series consists of:\nMetric name Set of labels (key-value pairs) Timestamp Value 3. In-Memory Data Structures Inverted index: For quickly finding time series matching specific labels Sorted time series: Ordered by timestamp for efficient range queries 4. On-Disk Storage Structures Blocks: Data organized into fixed time ranges WAL (Write-Ahead Log): Ensures data durability and crash recovery Index: Stores metadata and label information for fast querying 5. Compression Algorithms Prometheus uses various techniques to reduce storage space:\nDelta encoding: Storing differences between values XOR compression: For efficient compression of timestamps Varint encoding: For integer compression 6. Aggregation and Downsampling Supports data aggregation and downsampling for long-term storage Reduces precision and storage requirements of older data 7. Label Index Uses inverted indexing to quickly locate time series with specific labels ","wordCount":"675","inLanguage":"en","datePublished":"2024-09-07T00:00:00Z","dateModified":"2024-09-07T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://bleedkagax.github.io/post/2_prometheus/"},"publisher":{"@type":"Organization","name":"Kaga Blog","logo":{"@type":"ImageObject","url":"https://bleedkagax.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bleedkagax.github.io/ accesskey=h title="Kaga Blog (Alt + H)">Kaga Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Prometheus</h1><div class=post-meta><span title='2024-09-07 00:00:00 +0000 UTC'>September 7, 2024</span></div></header><div class=post-content><p><img loading=lazy src=/img/2_prometheus.png alt></p><h2 id=what-is-prometheus>What is Prometheus?<a hidden class=anchor aria-hidden=true href=#what-is-prometheus>#</a></h2><p>Prometheus is an open-source systems monitoring and alerting toolkit. It collects and stores metrics as time series data, allowing for flexible querying and real-time alerting.</p><h2 id=what-are-the-main-components-of-prometheus>What are the main components of Prometheus?<a hidden class=anchor aria-hidden=true href=#what-are-the-main-components-of-prometheus>#</a></h2><p>The main components of Prometheus are:</p><ul><li>Prometheus server (for scraping and storing time series data)</li><li>Client libraries (for instrumenting application code)</li><li>Push gateway (for supporting short-lived jobs)</li><li>Exporters (for services that don&rsquo;t expose Prometheus metrics directly)</li><li>Alertmanager (for handling alerts)</li></ul><h2 id=how-does-prometheus-collect-metrics>How does Prometheus collect metrics?<a hidden class=anchor aria-hidden=true href=#how-does-prometheus-collect-metrics>#</a></h2><p>Prometheus uses a pull model to collect metrics. It scrapes metrics from configured targets at regular intervals, usually by HTTP endpoints on these targets.</p><h2 id=what-is-promql>What is PromQL?<a hidden class=anchor aria-hidden=true href=#what-is-promql>#</a></h2><p>PromQL (Prometheus Query Language) is Prometheus&rsquo;s flexible query language that lets the user select and aggregate time series data in real time.</p><h2 id=explain-the-difference-between-counter-gauge-and-histogram-metric-types-in-prometheus>Explain the difference between counter, gauge, and histogram metric types in Prometheus.<a hidden class=anchor aria-hidden=true href=#explain-the-difference-between-counter-gauge-and-histogram-metric-types-in-prometheus>#</a></h2><ul><li>Counter: A cumulative metric that only increases (e.g., number of requests)</li><li>Gauge: A metric that can increase and decrease (e.g., memory usage)</li><li>Histogram: Samples observations and counts them in configurable buckets (e.g., request durations)</li></ul><h2 id=what-is-service-discovery-in-prometheus>What is service discovery in Prometheus?<a hidden class=anchor aria-hidden=true href=#what-is-service-discovery-in-prometheus>#</a></h2><p>Service discovery is the process by which Prometheus automatically finds and monitors new targets in dynamic environments like cloud or container platforms.</p><h2 id=how-does-prometheus-handle-high-availability>How does Prometheus handle high availability?<a hidden class=anchor aria-hidden=true href=#how-does-prometheus-handle-high-availability>#</a></h2><p>Prometheus can be run in a clustered mode for high availability. Multiple Prometheus servers can scrape the same targets, and Alertmanager can be clustered to provide redundancy for alerts.</p><h2 id=what-is-the-role-of-alertmanager-in-prometheus>What is the role of Alertmanager in Prometheus?<a hidden class=anchor aria-hidden=true href=#what-is-the-role-of-alertmanager-in-prometheus>#</a></h2><p>Alertmanager handles alerts sent by client applications such as the Prometheus server. It takes care of deduplicating, grouping, and routing alerts to the correct receiver (e.g., email, PagerDuty, Slack).</p><h2 id=how-does-prometheus-store-data>How does Prometheus store data?<a hidden class=anchor aria-hidden=true href=#how-does-prometheus-store-data>#</a></h2><p>Prometheus stores data in a custom, efficient time-series database on local storage. It also optionally integrates with remote storage systems.</p><h2 id=what-is-the-purpose-of-exporters-in-prometheus>What is the purpose of exporters in Prometheus?<a hidden class=anchor aria-hidden=true href=#what-is-the-purpose-of-exporters-in-prometheus>#</a></h2><p>Exporters are used to export existing metrics from third-party systems as Prometheus metrics. They collect the metrics from the target system and translate them into a format that Prometheus can ingest.</p><h2 id=how-can-you-monitor-prometheus-itself>How can you monitor Prometheus itself?<a hidden class=anchor aria-hidden=true href=#how-can-you-monitor-prometheus-itself>#</a></h2><p>Prometheus can monitor itself by scraping its own HTTP endpoint. This allows you to track metrics about Prometheus&rsquo; own performance and behavior.</p><h2 id=what-is-the-difference-between-push-and-pull-models-in-monitoring-and-which-does-prometheus-use>What is the difference between push and pull models in monitoring, and which does Prometheus use?<a hidden class=anchor aria-hidden=true href=#what-is-the-difference-between-push-and-pull-models-in-monitoring-and-which-does-prometheus-use>#</a></h2><p>Prometheus uses a pull model, where it actively scrapes targets for metrics. In contrast, a push model involves targets actively sending metrics to the monitoring system. Prometheus&rsquo; pull model is simpler and allows for better detection of failures.</p><h2 id=how-does-prometheus-handle-labels>How does Prometheus handle labels?<a hidden class=anchor aria-hidden=true href=#how-does-prometheus-handle-labels>#</a></h2><p>Labels in Prometheus are key-value pairs associated with time series, e.g., <code>environment="production"</code>, <code>server="backend-01"</code>. They allow for multi-dimensional data model and flexible, powerful querying.</p><h2 id=what-is-recording-rules-in-prometheus>What is recording rules in Prometheus?<a hidden class=anchor aria-hidden=true href=#what-is-recording-rules-in-prometheus>#</a></h2><p>Recording rules allow you to precompute frequently needed or computationally expensive expressions and save their result as a new set of time series.</p><h2 id=how-does-prometheus-ensure-reliability-and-prevent-data-loss>How does Prometheus ensure reliability and prevent data loss?<a hidden class=anchor aria-hidden=true href=#how-does-prometheus-ensure-reliability-and-prevent-data-loss>#</a></h2><p>Prometheus uses local storage by default, which prevents data loss due to network issues. It also supports various service discovery mechanisms and can be run in a clustered mode for high availability.</p><h2 id=prometheus-underlying-data-structures>Prometheus Underlying Data Structures<a hidden class=anchor aria-hidden=true href=#prometheus-underlying-data-structures>#</a></h2><h3 id=1-time-series-database-tsdb>1. Time Series Database (TSDB)<a hidden class=anchor aria-hidden=true href=#1-time-series-database-tsdb>#</a></h3><ul><li>Custom-built for Prometheus</li><li>Optimized for time-series data</li><li>Supports efficient data compression and fast querying</li></ul><h3 id=2-sample-data>2. Sample Data<a hidden class=anchor aria-hidden=true href=#2-sample-data>#</a></h3><p>Each time series consists of:</p><ul><li>Metric name</li><li>Set of labels (key-value pairs)</li><li>Timestamp</li><li>Value</li></ul><h3 id=3-in-memory-data-structures>3. In-Memory Data Structures<a hidden class=anchor aria-hidden=true href=#3-in-memory-data-structures>#</a></h3><ul><li><strong>Inverted index</strong>: For quickly finding time series matching specific labels</li><li><strong>Sorted time series</strong>: Ordered by timestamp for efficient range queries</li></ul><h3 id=4-on-disk-storage-structures>4. On-Disk Storage Structures<a hidden class=anchor aria-hidden=true href=#4-on-disk-storage-structures>#</a></h3><ul><li><strong>Blocks</strong>: Data organized into fixed time ranges</li><li><strong>WAL (Write-Ahead Log)</strong>: Ensures data durability and crash recovery</li><li><strong>Index</strong>: Stores metadata and label information for fast querying</li></ul><h3 id=5-compression-algorithms>5. Compression Algorithms<a hidden class=anchor aria-hidden=true href=#5-compression-algorithms>#</a></h3><p>Prometheus uses various techniques to reduce storage space:</p><ul><li>Delta encoding: Storing differences between values</li><li>XOR compression: For efficient compression of timestamps</li><li>Varint encoding: For integer compression</li></ul><h3 id=6-aggregation-and-downsampling>6. Aggregation and Downsampling<a hidden class=anchor aria-hidden=true href=#6-aggregation-and-downsampling>#</a></h3><ul><li>Supports data aggregation and downsampling for long-term storage</li><li>Reduces precision and storage requirements of older data</li></ul><h3 id=7-label-index>7. Label Index<a hidden class=anchor aria-hidden=true href=#7-label-index>#</a></h3><ul><li>Uses inverted indexing to quickly locate time series with specific labels</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://bleedkagax.github.io/tags/systemdesign/>SystemDesign</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://bleedkagax.github.io/>Kaga Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script><script>(function(){var e=document.querySelectorAll("pre > code.language-mermaid");e.forEach(function(e){var t,n=e.parentElement;if(!n)return;t=document.createElement("div"),t.className="mermaid",t.textContent=e.textContent||"",n.replaceWith(t)})})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>